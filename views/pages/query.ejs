<html>
    <head>
        <title>Sanrio Database</title>
        <meta name="description" content="Index">
        <link rel="stylesheet" href="css/style.css">
        <link rel="preconnect" href="https://fonts.googleapis.com"> 
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css?family=Protest+Riot" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Berkshire+Swash" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Grandstander" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">
    </head>

    <div class="nav">
        <a href="index.html" class="logo">Kelsey Corro</a>
        <a href="index">Home</a>
        <a href="form">Form</a>
        <a href="collection">Collection</a>
        <a class="active" href="query">Queries</a>
    </div> 

    <body>

        <h1>Query Characters</h1>

        <div class="form-container">

            <form method="get" action="/before">
                <label for="creationYear">Characters Created Before Year:</label>
                <input type="number" id="creationYear" name="creationYear">
                <button type="submit">Search</button>
            </form>

        </div>

        <div id="queryResults"></div>

        <script>
            document.getElementById('queryForm').addEventListener('submit', async function(event) {
                event.preventDefault();
                const formData = new FormData(this);
                const creationYear = formData.get('creationYear');
                try {
                    const response = await fetch(`/before/${creationYear}`);
                    const data = await response.json();
                    displayResults(data);
                } catch (error) {
                    console.error('Error:', error);
                }
            });

            function displayResults(characters) {
                const queryResults = document.getElementById('queryResults');
                queryResults.innerHTML = '';

                if (characters.length === 0) {
                    queryResults.textContent = 'No characters found.';
                    return;
                }

                const ul = document.createElement('ul');
                characters.forEach(character => {
                    const li = document.createElement('li');
                    li.textContent = `${character.name} (${character.creation_year})`;
                    ul.appendChild(li);
                });
                queryResults.appendChild(ul);
            }
        </script>

    
    </body>
</html>